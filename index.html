<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>NEO Mobile ‚Ä¢ Address & Board (Offline Ready)</title>
<meta name="color-scheme" content="dark light">
<style>
  :root{
    --bg:#0c111b;--panel:#151b26;--muted:#7a8699;--text:#e8f0ff;--brand:#10b3d6;--brand2:#7ddc1f;--danger:#ff5a5f;
    --radius:14px;--shadow:0 8px 26px rgba(0,0,0,.35);
  }
  html,body{height:100%}
  body{
    margin:0;background:
      radial-gradient(700px 400px at 110% -10%, rgba(16,179,214,.18), transparent 60%),
      radial-gradient(700px 400px at -10% 110%, rgba(125,220,31,.15), transparent 60%),
      linear-gradient(180deg,#0c111b 0%, #0a0f18 100%);
    color:var(--text); font:16px/1.5 system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans Thai", "Noto Sans", sans-serif;
    -webkit-tap-highlight-color: transparent;
  }
  .container{max-width:680px;margin:0 auto;padding:16px 14px 84px}
  .topbar{position:sticky;top:0;z-index:10;background:linear-gradient(180deg, rgba(12,17,27,.9), rgba(12,17,27,.75));backdrop-filter:saturate(1.2) blur(6px);padding:10px 14px;border-bottom:1px solid rgba(255,255,255,.06)}
  .title{display:flex;align-items:center;gap:10px}
  .logo{width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,var(--brand),var(--brand2));display:grid;place-items:center;font-weight:900;color:#001219}
  .subtitle{font-size:11px;color:var(--muted);letter-spacing:.08em;text-transform:uppercase}
  .panel{background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);box-shadow:var(--shadow)}
  .pad{padding:14px}
  .grid{display:grid;gap:10px}
  .g2{grid-template-columns:1fr 1fr}
  .muted{color:var(--muted)}
  .btn{appearance:none;border:0;border-radius:12px;padding:13px 14px;font-weight:700;background:#1a2433;color:#e6f2ff}
  .btn:active{transform:translateY(1px)}
  .btn-primary{background:linear-gradient(90deg,var(--brand),#209ee2);color:white}
  .btn-ghost{background:#1a2433;color:#cfe8ff}
  .btn-danger{background:#2a1a1d;color:#ffd6d6;border:1px solid rgba(255,90,95,.35)}
  .row{display:flex;gap:10px;align-items:center}
  select,textarea,input{
    width:100%;background:#0f1520;color:#eaf2ff;border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:12px;
    font:inherit;
  }
  textarea{min-height:110px;resize:vertical}
  .stat{display:flex;flex-direction:column;gap:2px;text-align:center;padding:10px;background:#0f1520;border:1px solid rgba(255,255,255,.08);border-radius:12px}
  .stat .num{font-weight:900;font-size:20px}
  .result{min-height:160px;white-space:pre-wrap;font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "JetBrains Mono", monospace;padding:12px;background:#0f1520;border-radius:12px;border:1px solid rgba(255,255,255,.08)}
  .tip{font-size:12px;color:var(--muted)}
  .chip{display:inline-block;background:#112030;color:#bfe9ff;border:1px solid rgba(255,255,255,.08);border-radius:999px;padding:4px 8px;font-size:11px}
  .list{display:flex;flex-direction:column;gap:8px;max-height:180px;overflow:auto}
  .item{padding:10px;background:#0f1520;border:1px solid rgba(255,255,255,.08);border-radius:12px}
  .item .meta{display:flex;justify-content:space-between;gap:8px;color:var(--muted);font-size:11px;margin-top:6px}
  .bottomnav{
    position:fixed;left:0;right:0;bottom:0;z-index:20;padding:10px 12px;background:rgba(12,17,27,.96);backdrop-filter:blur(8px);
    border-top:1px solid rgba(255,255,255,.06);display:grid;grid-template-columns:repeat(3,1fr);gap:10px
  }
  .tabbtn{border-radius:12px;padding:10px;background:#1a2433;color:#cfe8ff;border:1px solid rgba(255,255,255,.06)}
  .tabbtn.active{background:linear-gradient(90deg,var(--brand),#1ea8df);color:#001219;font-weight:900}
  .hidden{display:none}
  .mark{background:#ffe172;color:#1b2436;padding:0 4px;border-radius:6px;font-weight:800}
  .toast{position:fixed;right:12px;bottom:72px;background:#0f2430;color:#e6f7ff;border:1px solid rgba(255,255,255,.12);padding:10px 12px;border-radius:10px;opacity:0;transform:translateY(10px);transition:.25s}
  .toast.show{opacity:1;transform:translateY(0)}
</style>
</head>
<body>
  <div class="topbar">
    <div class="title">
      <div class="logo">N</div>
      <div>
        <div style="font-weight:900">NEO Mobile Toolkit</div>
        <div class="subtitle">Address Forge & Local Board</div>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- TAB: Generator -->
    <section id="tab-gen" class="grid" aria-live="polite">
      <div class="panel pad grid">
        <div style="font-weight:800;font-size:18px">üîê ‡∏ï‡∏±‡∏ß‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏•‡∏±‡∏ö</div>
        <div class="grid g2">
          <label>
            <div class="tip">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</div>
            <select id="addressSelect">
              <option value="home">‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏ó‡∏¢‡∏™‡∏°‡∏∏‡∏ó‡∏£</option>
              <option value="alt1">‡∏ö‡πâ‡∏≤‡∏ô‡∏õ‡∏ó‡∏∏‡∏°</option>
            </select>
          </label>
          <label>
            <div class="tip">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏û‡∏£‡∏≤‡∏á</div>
            <select id="obfuscationSelect">
              <option value="low">‡∏ï‡πà‡∏≥ ‚Äî ‡∏≠‡πà‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</option>
              <option value="medium" selected>‡∏Å‡∏•‡∏≤‡∏á ‚Äî ‡∏™‡∏°‡∏î‡∏∏‡∏•</option>
              <option value="high">‡∏™‡∏π‡∏á ‚Äî ‡∏û‡∏£‡∏≤‡∏á‡∏´‡∏ô‡∏±‡∏Å</option>
              <option value="extreme">‡∏™‡∏∏‡∏î‡∏Ç‡∏±‡πâ‡∏ô ‚Äî ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å</option>
            </select>
          </label>
          <label>
            <div class="tip">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</div>
            <select id="linesSelect">
              <option value="auto" selected>‡∏™‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</option>
              <option value="1">1 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</option>
              <option value="2">2 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</option>
              <option value="3">3 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</option>
              <option value="4">4 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</option>
              <option value="5">5 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</option>
            </select>
          </label>
          <label>
            <div class="tip">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç</div>
            <select id="digitMode">
              <option value="mixed" selected>‡∏ú‡∏™‡∏° (‡πÑ‡∏ó‡∏¢/‡∏≠‡∏≤‡∏£‡∏ö‡∏¥‡∏Å)</option>
              <option value="thai">‡πÄ‡∏•‡∏Ç‡πÑ‡∏ó‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
              <option value="arabic">‡πÄ‡∏•‡∏Ç‡∏≠‡∏≤‡∏£‡∏ö‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
            </select>
          </label>
        </div>

        <div class="row" style="gap:8px;flex-wrap:wrap">
          <button id="generateBtn" class="btn btn-primary" style="flex:1">üé≤ ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
          <button id="copyBtn" class="btn btn-ghost" style="flex:1">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
          <button id="clearBtn" class="btn btn-ghost" style="flex:1">üßπ ‡∏•‡πâ‡∏≤‡∏á</button>
          <button id="saveBtn" class="btn btn-ghost" style="flex:1">‚¨áÔ∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå</button>
        </div>

        <div class="grid g2">
          <div class="stat"><div class="num" id="generateCount">0</div><div class="tip">‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á</div></div>
          <div class="stat"><div class="num" id="copyCount">0</div><div class="tip">‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</div></div>
        </div>

        <div>
          <div class="row" style="justify-content:space-between">
            <div class="chip">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: <b id="currentVariation" style="margin-left:6px">A1</b></div>
            <div class="tip" id="generationTime"></div>
          </div>
          <div id="resultDisplay" class="result" style="margin-top:8px"></div>
        </div>

        <div>
          <div style="font-weight:700;margin:6px 0 4px">üìö ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
          <div id="historyContainer" class="list"><div class="tip">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</div></div>
        </div>
      </div>

      <div class="panel pad">
        <div style="font-weight:700">üß™ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏â‡∏•‡∏≤‡∏Å (‡∏õ‡∏Å‡∏ï‡∏¥/‡πÄ‡∏û‡∏µ‡πâ‡∏¢‡∏ô)</div>
        <div id="labelPreview" class="row" style="flex-wrap:wrap;margin-top:8px;gap:6px"></div>
        <div class="tip" style="margin-top:6px">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏∏‡πà‡∏°‡∏â‡∏•‡∏≤‡∏Å ‡πÅ‡∏•‡∏∞‡∏≠‡∏≤‡∏à‡πÅ‡∏ó‡∏£‡∏Å‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå/‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ô‡∏ö‡∏≠‡∏ó‡∏≠‡πà‡∏≤‡∏ô</div>
      </div>
    </section>

    <!-- TAB: Board (Local Only) -->
    <section id="tab-board" class="grid hidden">
      <div class="panel pad grid">
        <div style="font-weight:800;font-size:18px">üí¨ ‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á)</div>
        <label>
          <div class="tip">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</div>
          <input id="titleInput" type="text" maxlength="120" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡πâ‡∏ô‡πÜ">
        </label>
        <label>
          <div class="tip">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</div>
          <textarea id="messageInput" maxlength="1000" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."></textarea>
        </label>
        <div class="row" style="justify-content:space-between">
          <div class="tip"><span id="charLeft">1000</span> ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠</div>
          <div class="tip">‡πÇ‡∏´‡∏°‡∏î: <b>‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå/‡πÇ‡∏•‡∏Ñ‡∏≠‡∏•</b></div>
        </div>
        <div class="row">
          <button id="postBtn" class="btn btn-primary" style="flex:2">‡πÇ‡∏û‡∏™‡∏ï‡πå</button>
          <button id="clearCompose" class="btn btn-ghost" style="flex:1">‡∏•‡πâ‡∏≤‡∏á</button>
        </div>
      </div>

      <div class="panel pad grid">
        <div style="font-weight:700">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏û‡∏™‡∏ï‡πå</div>
        <div id="messages" class="list"></div>
      </div>
    </section>

    <!-- TAB: About/Help -->
    <section id="tab-help" class="grid hidden">
      <div class="panel pad grid">
        <div style="font-weight:800;font-size:18px">‚ÑπÔ∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏â‡∏ö‡∏±‡∏ö‡∏¢‡πà‡∏≠</div>
        <ul class="tip" style="margin:6px 0 0 18px">
          <li>‡πÅ‡∏ï‡∏∞ ‚Äú‡∏™‡∏£‡πâ‡∏≤‡∏á‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà/‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÅ‡∏ö‡∏ö‡∏û‡∏£‡∏≤‡∏á</li>
          <li>‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å/‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° ‚Äú‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‚Äù</li>
          <li>‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏•‡∏ö/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ)</li>
        </ul>
        <div class="tip" style="margin-top:8px">* ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå, ‡πÑ‡∏°‡πà‡∏û‡∏∂‡πà‡∏á‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ)</div>
      </div>
    </section>
  </div>

  <!-- Bottom Nav -->
  <nav class="bottomnav">
    <button class="tabbtn active" data-tab="gen">üîê ‡∏™‡∏£‡πâ‡∏≤‡∏á</button>
    <button class="tabbtn" data-tab="board">üí¨ ‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
    <button class="tabbtn" data-tab="help">‚ÑπÔ∏è ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠</button>
  </nav>

  <div id="toast" class="toast">‚Äî</div>

<script>
/* ===== Utilities (Mobile-friendly, no deps) ===== */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));
const toast = $('#toast');
function showToast(msg){ toast.textContent = msg; toast.classList.add('show'); clearTimeout(showToast.t); showToast.t=setTimeout(()=>toast.classList.remove('show'),1500); }
function rnd(a){ return a[Math.floor(Math.random()*a.length)] }
function zws(s){ return s.split('').join('\u200b') }
function toThaiDigits(str){ return String(str).replace(/[0-9]/g,d=>'‡πê‡πë‡πí‡πì‡πî‡πï‡πñ‡πó‡πò‡πô'[d]) }
function toArabicDigits(str){ return String(str).replace(/[‡πê-‡πô]/g,d=>'0123456789'['‡πê‡πë‡πí‡πì‡πî‡πï‡πñ‡πó‡πò‡πô'.indexOf(d)]) }

/* ===== Tabs (Bottom Nav) ===== */
const tabs = {gen: $('#tab-gen'), board: $('#tab-board'), help: $('#tab-help')};
$$('.tabbtn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    $$('.tabbtn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const t = btn.dataset.tab;
    Object.entries(tabs).forEach(([k,el])=> el.classList.toggle('hidden', k!==t));
    window.scrollTo({top:0, behavior:'smooth'});
  });
});

/* ===== Address Generator ===== */
const ADDRESSES = {
  home: { houseNumber: "62/37", soi: "‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á16", village: "‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô‡πÑ‡∏ó‡∏¢‡∏™‡∏°‡∏∏‡∏ó‡∏£2", road: "‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á", subdistrict: "‡∏£‡∏≤‡∏ä‡∏≤‡πÄ‡∏ó‡∏ß‡∏∞", district: "‡∏ö‡∏≤‡∏á‡∏û‡∏•‡∏µ", province: "‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£", postalCode: "10540" },
  alt1: { houseNumber: "22/4", soi: "‡πÉ‡∏à‡πÄ‡∏≠‡∏∑‡πâ‡∏≠ 2", village: "", road: "", subdistrict: "‡∏ö‡∏≤‡∏á‡∏Ç‡∏∞‡πÅ‡∏¢‡∏á", district: "", province: "‡∏õ‡∏ó‡∏∏‡∏°‡∏ò‡∏≤‡∏ô‡∏µ", postalCode: "12000" }
};
const PHONES = { home: "0961408164", alt1: "0946401569" };

const Labels = {
  house: ['‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà','‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà','No.','#',''],
  phone: ['‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå','Tel','‡πÇ‡∏ó‡∏£','‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£',''],
  soi: ['‡∏ã‡∏≠‡∏¢','‡∏ã.','Soi',''],
  village: ['‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô','‡∏°.','‡∏´‡∏°‡∏π‡πà',''],
  road: ['‡∏ñ‡∏ô‡∏ô','‡∏ñ.','Rd.',''],
  subdistrict: ['‡∏ï‡∏≥‡∏ö‡∏•','‡∏ï.',''],
  district: ['‡∏≠‡∏≥‡πÄ‡∏†‡∏≠','‡∏≠.',''],
  province: ['‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î','‡∏à.',''],
  postal: ['‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå','‡∏£‡∏´‡∏±‡∏™','Zip','']
};
const FuzzyLabels = {
  house: ['‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡πÖ‡∏ó‡∏µ‡πà','‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏ã‡∏ó‡∏µ‡πà','‡∏ö‡πâ‡∏≤‡∏ô‡πÄx‡∏Ç‡∏ó‡∏µ‡πà','‡∏ö‡πâ‡∏≤u‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà'],
  phone: ['‡πÇ‡∏ós‡∏±‡∏û‡∏ó‡πå','‡πÇ‡∏ó‡∏£s‡∏±s‡∏ó‡πå','‡πÇ‡∏óp‡∏®‡∏±‡∏û','‡πÇ‡∏ó‡∏£s‡∏±‡∏ö'],
  soi: ['‡∏ão‡∏¢','‡∏ãx‡∏¢','‡∏ã0‡∏¢'],
  village: ['‡∏´‡∏°‡∏π‡πà‡∏ö‡∏≤u','‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤u','‡∏´‡∏°‡∏πv‡∏ö‡∏≤u'],
  road: ['‡∏ñu‡∏ô','‡∏ñuv','‡∏ñv‡∏ô'],
  subdistrict: ['‡∏ï‡∏≥‡∏öu','‡∏ï‡πç‡∏≤‡∏ö‡∏•','‡∏ïx‡∏ö‡∏•'],
  district: ['‡∏≠‡∏≥p‡∏≠','‡∏≠‡∏≥‡πÄ‡πÖ‡∏≠','‡∏≠‡πç‡∏≤‡πÄ‡∏†o'],
  province: ['‡∏à‡∏±‡∏á‡∏´‡∏ß‡πâ‡∏î','‡∏à‡∏±n‡∏´‡∏ß‡∏±‡∏î','‡∏à‡∏±J‡∏´‡∏ß‡∏±‡∏î'],
  postal: ['‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õs‡∏©‡∏ì‡∏µ‡∏¢‡πå','‡∏£‡∏´‡∏±n‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå','‡∏£‡∏´‡∏±‡∏™‡πÑp‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå']
};
const Punct = ['.', ',', '/', '-', '_'];
const Seps  = [', ',' ',' ‚Ä¢ ',' ‚Äî '];

const addressSelect = $('#addressSelect');
const obfuscationSelect = $('#obfuscationSelect');
const linesSelect = $('#linesSelect');
const digitMode = $('#digitMode');
const resultDisplay = $('#resultDisplay');
const generationTime = $('#generationTime');
const labelPreview = $('#labelPreview');
const generateCountEl = $('#generateCount');
const copyCountEl = $('#copyCount');
const currentVariationEl = $('#currentVariation');
const historyContainer = $('#historyContainer');

const stats = { generateCount: 0, copyCount: 0 };
const history = [];

function injectPunc(str, level){
  const chance = {low:0, medium:.05, high:.15, extreme:.3}[level] || 0;
  if (!chance) return str;
  let out = '';
  for (const ch of String(str)) {
    out += ch;
    if (Math.random()<chance && ch!==' ' && !Punct.includes(ch)) out += rnd(Punct);
  }
  return out;
}
function formatNumber(num){
  if (!num) return '';
  const s = String(num);
  return rnd([s, s.replace('/', ' / '), s.replace('/', '-'), `No.${s}`, s.split('').join(' ')]);
}
function formatPhone(p){
  if (!p) return '';
  return rnd([
    p,
    p.replace(/(\d{3})(\d{3})(\d{4})/,'$1-$2-$3'),
    p.replace(/(\d{3})(\d{3})(\d{4})/,'$1 $2 $3'),
    '+66 '+p.slice(1)
  ]);
}
function variationCode(){
  const A='ABCDEFGHIJKLMNOPQRSTUVWXYZ', D='0123456789';
  return A[Math.floor(Math.random()*A.length)]+D[Math.floor(Math.random()*D.length)];
}
function applyDigitMode(s){
  if (digitMode.value==='thai') return toThaiDigits(s);
  if (digitMode.value==='arabic') return toArabicDigits(s);
  return Math.random()<.5? toThaiDigits(s) : String(s);
}
function renderLabelPreview(){
  const keys = ['house','phone','soi','village','road','subdistrict','district','province','postal'];
  labelPreview.innerHTML = keys.map(k=>{
    const normal = rnd(Labels[k])||'‚Äî';
    const fuzzy  = FuzzyLabels[k]? rnd(FuzzyLabels[k]) : '';
    return `<span class="chip">${normal}</span><span class="chip" style="opacity:.7">${fuzzy}</span>`;
  }).join(' ');
}

function generateAddress(){
  const t0 = performance.now();
  const level = obfuscationSelect.value;
  const addr = ADDRESSES[addressSelect.value];
  const phone = PHONES[addressSelect.value];

  const comps = [
    {key:'house', value:`<span class="mark">${formatNumber(applyDigitMode(addr.houseNumber))}</span>`, label:Labels.house, required:!!addr.houseNumber},
    {key:'phone', value:applyDigitMode(formatPhone(phone)), label:Labels.phone, required:!!phone},
    {key:'soi', value:addr.soi, label:Labels.soi},
    {key:'village', value:addr.village, label:Labels.village},
    {key:'road', value:addr.road, label:Labels.road},
    {key:'subdistrict', value:addr.subdistrict, label:Labels.subdistrict},
    {key:'district', value:addr.district, label:Labels.district},
    {key:'province', value:addr.province, label:Labels.province},
    {key:'postal', value:applyDigitMode(addr.postalCode), label:Labels.postal}
  ].filter(c=>c.value && String(c.value).replace(/<[^>]*>/g,'').trim()!=='');

  const req = comps.filter(c=>c.required);
  const opt = comps.filter(c=>!c.required);
  const nOpt = Math.max(2, Math.min(opt.length, Math.floor(Math.random()*(opt.length-1))+2));
  const selected = [...req, ...opt.sort(()=>0.5-Math.random()).slice(0,nOpt)].sort(()=>0.5-Math.random());

  const parts = selected.map(comp=>{
    let label = rnd(comp.label);
    if (Math.random()<.4 && FuzzyLabels[comp.key]?.length) label = rnd(FuzzyLabels[comp.key]);
    const showLabel = label && (comp.required || Math.random()>.3);
    const value = comp.key==='house' ? comp.value : injectPunc(comp.value, level);
    let part = showLabel ? `${label} ${value}` : value;

    // zero-width obfuscation ‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ mark
    if (comp.key!=='house') {
      if (level==='extreme' && Math.random()<.5) return zws(part);
      if (level==='high' && Math.random()<.3) return zws(part);
    }
    return part.trim();
  }).filter(Boolean);

  let lines = linesSelect.value==='auto' ? Math.floor(Math.random()*4)+1 : parseInt(linesSelect.value,10);
  if (lines>parts.length) lines = parts.length;
  let out;
  if (lines<=1){
    out = parts.join(rnd(Seps));
  } else {
    const buckets = Array.from({length:lines},()=>[]);
    parts.forEach((p,i)=>buckets[i%lines].push(p));
    out = buckets.map(b=>b.join(' ')).join('\n');
  }

  stats.generateCount++;
  generateCountEl.textContent = stats.generateCount;
  const vv = variationCode();
  currentVariationEl.textContent = vv;
  resultDisplay.innerHTML = out.replace(/\n/g,'<br>');
  generationTime.textContent = `Generated in ${Math.max(1,Math.round(performance.now()-t0))}ms`;

  history.unshift({id:Date.now(), v:vv, text: out, at: new Date().toLocaleTimeString('th-TH')});
  if (history.length>6) history.pop();
  renderHistory();
}
function renderHistory(){
  if (!history.length){ historyContainer.innerHTML = '<div class="tip">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</div>'; return; }
  historyContainer.innerHTML = history.map(h=>`
    <button class="item" data-hid="${h.id}">
      <div style="display:flex;justify-content:space-between;gap:8px">
        <div class="chip">#${h.v}</div>
        <div class="tip">${h.at}</div>
      </div>
      <div class="tip" style="margin-top:6px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${h.text.replace(/\n/g,'  ')}</div>
    </button>
  `).join('');
  $$('#historyContainer .item').forEach(el=>{
    el.addEventListener('click', ()=>{
      const id = +el.dataset.hid;
      const item = history.find(x=>x.id===id);
      if (item){ resultDisplay.innerHTML = item.text.replace(/\n/g,'<br>'); showToast(`‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å #${item.v}`); }
    });
  });
}

/* ===== Actions ===== */
$('#generateBtn').addEventListener('click', generateAddress);
$('#copyBtn').addEventListener('click', ()=>{
  const text = resultDisplay.textContent||'';
  if (!text.trim()) return showToast('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å');
  navigator.clipboard.writeText(text).then(()=>{ stats.copyCount++; copyCountEl.textContent = stats.copyCount; showToast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úÖ'); });
});
$('#clearBtn').addEventListener('click', ()=>{
  stats.generateCount=0;stats.copyCount=0;generateCountEl.textContent='0';copyCountEl.textContent='0';
  currentVariationEl.textContent='‚Äî';generationTime.textContent='';resultDisplay.textContent='';history.length=0;renderHistory(); showToast('‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß');
});
$('#saveBtn').addEventListener('click', ()=>{
  const text = resultDisplay.textContent||'';
  if (!text.trim()) return showToast('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
  const blob = new Blob([text], {type:'text/plain;charset=utf-8'});
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `address-${Date.now()}.txt`; a.click(); URL.revokeObjectURL(a.href);
  showToast('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡πâ‡∏ß ‚¨áÔ∏è');
});
[addressSelect, obfuscationSelect, linesSelect, digitMode].forEach(el=> el.addEventListener('change', ()=>{ localStorage.setItem('neo_ctrl', JSON.stringify({a:addressSelect.value,o:obfuscationSelect.value,l:linesSelect.value,d:digitMode.value})); renderLabelPreview(); }));

/* Restore controls */
try{
  const c = JSON.parse(localStorage.getItem('neo_ctrl')||'{}');
  if(c.a) addressSelect.value=c.a;
  if(c.o) obfuscationSelect.value=c.o;
  if(c.l) linesSelect.value=c.l;
  if(c.d) digitMode.value=c.d;
}catch{}

/* Label preview + first generate */
renderLabelPreview();
generateAddress();

/* ===== Local Board (no internet, per-device) ===== */
const BOARD_KEY = 'neo_board_messages_v1';
const DEVICE_ID_KEY = 'neo_device_id';
function uid(){ return Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2); }
let DEVICE = localStorage.getItem(DEVICE_ID_KEY);
if(!DEVICE){ DEVICE = uid(); localStorage.setItem(DEVICE_ID_KEY, DEVICE); }

const titleInput = $('#titleInput');
const messageInput = $('#messageInput');
const charLeft = $('#charLeft');
const messagesEl = $('#messages');

messageInput.addEventListener('input', ()=>{ charLeft.textContent = String(1000 - messageInput.value.length); });

$('#clearCompose').addEventListener('click', ()=>{ titleInput.value=''; messageInput.value=''; charLeft.textContent='1000'; });
$('#postBtn').addEventListener('click', ()=>{
  const text = (messageInput.value||'').trim(); if(!text) return showToast('‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô');
  const title = (titleInput.value||'').trim().slice(0,120);
  const arr = getMsgs();
  arr.unshift({ id:Date.now()+':'+uid(), title, text: text.slice(0,1000), ts: Date.now(), author: DEVICE });
  saveMsgs(arr);
  titleInput.value=''; messageInput.value=''; charLeft.textContent='1000';
  renderMsgs();
  showToast('‡πÇ‡∏û‡∏™‡∏ï‡πå‡πÅ‡∏•‡πâ‡∏ß');
});

function getMsgs(){ try{ return JSON.parse(localStorage.getItem(BOARD_KEY)||'[]'); }catch{return []} }
function saveMsgs(arr){ localStorage.setItem(BOARD_KEY, JSON.stringify(arr)); }
function delMsg(id){
  const arr = getMsgs().filter(m=>m.id!==id);
  saveMsgs(arr); renderMsgs(); showToast('‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß');
}
function renderMsgs(){
  const arr = getMsgs();
  if(!arr.length){ messagesEl.innerHTML = '<div class="tip">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</div>'; return; }
  messagesEl.innerHTML = arr.map(m=>{
    const mine = m.author===DEVICE;
    return `
      <div class="item">
        ${m.title? `<div style="font-weight:700">${escape(m.title)}</div>`:''}
        <div style="white-space:pre-wrap;margin-top:4px">${escape(m.text)}</div>
        <div class="meta">
          <div>${new Date(m.ts).toLocaleString('th-TH')}</div>
          <div class="row" style="gap:6px">
            <button class="btn btn-ghost" data-copy="${m.id}" style="padding:6px 10px;font-size:12px">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
            ${mine? `<button class="btn btn-danger" data-del="${m.id}" style="padding:6px 10px;font-size:12px">‡∏•‡∏ö</button>`:''}
          </div>
        </div>
      </div>
    `;
  }).join('');
  // bind events
  $$('#messages [data-copy]').forEach(b=>{
    b.addEventListener('click', ()=>{
      const id = b.dataset.copy; const m = getMsgs().find(x=>x.id===id);
      if (!m) return;
      navigator.clipboard.writeText(m.text).then(()=> showToast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß'));
    });
  });
  $$('#messages [data-del]').forEach(b=>{
    b.addEventListener('click', ()=>{
      const id = b.dataset.del; if(confirm('‡∏•‡∏ö‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) delMsg(id);
    });
  });
}
function escape(s=''){ const p=document.createElement('p'); p.textContent=s; return p.innerHTML; }
renderMsgs();

/* ===== Mobile niceties ===== */
document.addEventListener('keydown', (e)=>{
  if (['INPUT','TEXTAREA'].includes(e.target.tagName)) return;
  if (e.key.toLowerCase()==='g') generateAddress();
  if (e.key.toLowerCase()==='c') {
    const t = resultDisplay.textContent||''; if(!t.trim()) return;
    navigator.clipboard.writeText(t).then(()=>{ stats.copyCount++; copyCountEl.textContent = stats.copyCount; showToast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß ‚úÖ'); });
  }
});
</script>
</body>
</html>
